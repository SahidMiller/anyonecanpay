(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsProvider = factory()}(typeof self !== 'undefined' ? self : this, function () {
var IpfsProvider=(()=>{var c=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var I=c((S,x)=>{"use strict";x.exports=typeof self=="object"&&self.self===self&&self||typeof globalThis=="object"&&globalThis.global===globalThis&&globalThis||S});var q=c((Jt,R)=>{"use strict";R.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var C=c((U,A)=>{"use strict";var w=q(),{hasOwnProperty:v}=Object.prototype,{propertyIsEnumerable:rt}=Object,u=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),st=U,E={concatArrays:!1,ignoreUndefined:!1},y=t=>{let e=[];for(let r in t)v.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let s of r)rt.call(t,s)&&e.push(s)}return e};function p(t){return Array.isArray(t)?nt(t):w(t)?ot(t):t}function nt(t){let e=t.slice(0,0);return y(t).forEach(r=>{u(e,r,p(t[r]))}),e}function ot(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return y(t).forEach(r=>{u(e,r,p(t[r]))}),e}var L=(t,e,r,s)=>(r.forEach(n=>{typeof e[n]=="undefined"&&s.ignoreUndefined||(n in t&&t[n]!==Object.getPrototypeOf(t)?u(t,n,g(t[n],e[n],s)):u(t,n,p(e[n])))}),t),it=(t,e,r)=>{let s=t.slice(0,0),n=0;return[t,e].forEach(o=>{let a=[];for(let i=0;i<o.length;i++)!v.call(o,i)||(a.push(String(i)),o===t?u(s,n++,o[i]):u(s,n++,p(o[i])));s=L(s,o,y(o).filter(i=>!a.includes(i)),r)}),s};function g(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?it(t,e,r):!w(e)||!w(t)?p(e):L(t,e,y(e),r)}A.exports=function(...t){let e=g(p(E),this!==st&&this||{},E),r={_:{}};for(let s of t)if(s!==void 0){if(!w(s))throw new TypeError("`"+s+"` is not an Option Object");r=g(r,{_:s},e)}return r._}});var h=c((_t,j)=>{"use strict";j.exports={httpClient:"httpClient",windowIpfs:"windowIpfs",jsIpfs:"jsIpfs",webExt:"webExt"}});var $=c((Dt,N)=>{"use strict";var ct=h();async function at({root:t,connectionTest:e}){if(typeof t.chrome=="object"&&t.chrome.extension&&t.chrome.extension.getBackgroundPage){let r=null;try{r=t.chrome.extension.getBackgroundPage()}catch(s){return null}if(r&&r.ipfs){let{ipfs:s}=r;return await e(s),{ipfs:s,provider:ct.webExt}}}}N.exports=at});var J=c((Tt,H)=>{"use strict";var ut=h();async function pt({root:t,permissions:e,connectionTest:r}){if(t.ipfs){e&&e.commands&&e.commands.includes("files.get")||(e=e||{},e=JSON.parse(JSON.stringify(e)),e.commands=e.commands||[],e.commands.push("files.get"));let s=typeof t.ipfs.enable=="function"?await t.ipfs.enable(e):t.ipfs;return await r(s),{ipfs:s,provider:ut.windowIpfs}}}H.exports=pt});var O=c((Wt,T)=>{"use strict";var ht=typeof navigator!="undefined"&&navigator.product==="ReactNative";function ft(){return ht?"http://localhost":self.location.protocol+"//"+self.location.host}var f=self.URL,_=ft(),D=class{constructor(e="",r=_){this.super=new f(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return f.createObjectURL(e)}static revokeObjectURL(e){f.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function lt(t){if(typeof t=="string")return new f(t).toString();if(!(t instanceof f)){let e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",s=t.port?":"+t.port:"",n=t.protocol?t.protocol+"//":"",o=t.host||"",a=t.hostname||"",i=t.search||(t.query?"?"+t.query:""),d=t.hash||"",tt=t.pathname||"",et=t.path||tt+i;return`${n}${e||r}${o||a+s}${et}${d}`}}T.exports={URLWithLegacySupport:D,URLSearchParams:self.URLSearchParams,defaultBase:_,format:lt}});var V=c((Bt,B)=>{"use strict";var{URLWithLegacySupport:W,format:dt}=O();B.exports=(t,e={},r={},s)=>{let n=e.protocol?e.protocol.replace(":",""):"http";n=(r[n]||s||n)+":";let o;try{o=new W(t)}catch(i){o={}}let a=Object.assign({},e,{protocol:n||o.protocol,host:e.host||o.host});return new W(t,dt(a)).toString()}});var z=c((Vt,X)=>{"use strict";var{URLWithLegacySupport:wt,format:yt,URLSearchParams:gt,defaultBase:Ot}=O(),mt=V();X.exports={URL:wt,URLSearchParams:gt,format:yt,relative:mt,defaultBase:Ot}});var K=c((Xt,F)=>{"use strict";F.exports={DEFAULT_HTTP_API:"/ip4/127.0.0.1/tcp/5001"}});var G=c((zt,k)=>{"use strict";var{URL:bt}=z(),Pt=h(),{DEFAULT_HTTP_API:St}=K();async function xt({loadHttpClientModule:t,apiAddress:e,root:r,connectionTest:s,...n}){let o;if(t&&(o=await t()),!o)if(r.IpfsHttpClient)o=r.IpfsHttpClient;else throw new Error("ipfs-provider could not initialize js-ipfs-http-client: make sure its constructor is returned by loadHttpClientModule function or exposed at window.IpfsHttpClient");if(o=o.default||o,e||n.url||n.host)return m({apiAddress:e,connectionTest:s,httpClient:o,...n});let{location:a}=r;if(a&&!(a.port==="5001"&&a.hostname.match(/^127.0.0.1$|^localhost$/))){let i=new bt(a.origin);i.pathname="/";let d=await m({apiAddress:i.toString(),connectionTest:s,httpClient:o,...n});if(d)return d}return m({apiAddress:St,connectionTest:s,httpClient:o,...n})}async function m({apiAddress:t,connectionTest:e,httpClient:r,...s}){try{let n;try{n=r.create({...s,...Q(t)})}catch(o){n=r({...s,...Q(t)})}return await e(n),{ipfs:n,provider:Pt.httpClient,apiAddress:t}}catch(n){return null}}var Q=t=>{switch(typeof t){case"string":return{url:t};case"object":return JSON.parse(JSON.stringify(t));case"undefined":return{};default:throw new Error("invalid apiAddress passed to httpClient")}};k.exports=xt});var Z=c((Ft,Y)=>{"use strict";var It=h();async function Rt(t,e){return t=t.default||t,t.create(e)}async function qt({connectionTest:t,loadJsIpfsModule:e,options:r,init:s=Rt}){let n=await e(),o=await s(n,r);return await t(o),{ipfs:o,provider:It.jsIpfs}}Y.exports=qt});var $t=c((Kt,M)=>{"use strict";var b=I(),vt=C(),Et=$(),Lt=J(),Ut=G(),At=Z(),Ct={connectionTest:async t=>{let e="QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn";for await(let r of t.get(e))if(r.type==="dir"&&r.name===e)return!0;return!1}},l=(t,e={})=>(r={})=>s=>(r=vt(Ct,e,s,r),t(r)),P={httpClient:l(t=>Ut({root:b,...t})),windowIpfs:l(t=>Lt({root:b,...t})),jsIpfs:l(t=>At(t)),webExt:l(t=>Et({root:b,...t}))},jt=[P.windowIpfs(),P.httpClient()];async function Nt({providers:t=jt,...e}={}){for(let r of t)try{let s=await r(e);if(s)return s}catch(s){console.error("[ipfs-provider]",s)}}M.exports={getIpfs:Nt,providers:P,makeProvider:l}});return $t();})();
return IpfsProvider}));
